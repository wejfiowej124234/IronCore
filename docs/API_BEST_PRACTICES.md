# APIè®¾è®¡æœ€ä½³å®è·µ - å·²å®ç°

## ğŸ“‹ HTTPçŠ¶æ€ç è§„èŒƒ

### âœ… å·²éµå¾ªçš„è§„èŒƒ

#### **200 OK** - æˆåŠŸï¼ˆåŒ…æ‹¬ç©ºæ•°æ®ï¼‰
```json
// ç¤ºä¾‹1: æœ‰æ•°æ®
GET /api/wallets
â†’ 200 [{"id":"w1",...}, {"id":"w2",...}]

// ç¤ºä¾‹2: ç©ºæ•°æ®ï¼ˆä»ç„¶æ˜¯200ï¼Œä¸æ˜¯404ï¼‰
GET /api/transactions/history
â†’ 200 {"items":[],"total":0,"page":0,"page_size":20}

// ç¤ºä¾‹3: é’±åŒ…å­˜åœ¨ä½†æ— äº¤æ˜“
GET /api/wallets/w1/transactions
â†’ 200 {"transactions":[],"total":0,"message":"é’±åŒ…æš‚æ— äº¤æ˜“è®°å½•"}
```

**åŸåˆ™**: åªè¦è¯·æ±‚æ ¼å¼æ­£ç¡®ä¸”èµ„æºå­˜åœ¨ï¼Œå³ä½¿æ•°æ®ä¸ºç©ºä¹Ÿè¿”å›200ã€‚

#### **404 Not Found** - èµ„æºä¸å­˜åœ¨
```json
// ä»…å½“é’±åŒ…IDä¸å­˜åœ¨æ—¶è¿”å›404
GET /api/wallets/invalid_id/balance
â†’ 404 {
  "error": "Wallet not found",
  "message": "é’±åŒ… 'invalid_id' ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥é’±åŒ…IDæ˜¯å¦æ­£ç¡®",
  "wallet_id": "invalid_id"
}
```

**åŸåˆ™**: 
- âœ… é’±åŒ…IDä¸å­˜åœ¨ â†’ 404
- âœ… é’±åŒ…å­˜åœ¨ä½†ä½™é¢ä¸º0 â†’ 200
- âœ… é’±åŒ…å­˜åœ¨ä½†æ— äº¤æ˜“ â†’ 200 + ç©ºæ•°ç»„

#### **401 Unauthorized** - æœªæˆæƒ
```json
// éœ€è¦API Keyä½†æœªæä¾›
GET /api/wallets (with auth enabled)
â†’ 401 {
  "error": "Unauthorized",
  "message": "Valid API key required"
}
```

#### **501 Not Implemented** - åŠŸèƒ½æœªå¼€é€š
```json
// æœªæ¥å¯ä»¥ç”¨äºæœªå®ç°çš„åŠŸèƒ½
GET /api/wallets/{id}/nft-assets
â†’ 501 {
  "error": "Not implemented",
  "message": "NFTèµ„äº§æŸ¥è¯¢åŠŸèƒ½å³å°†ä¸Šçº¿",
  "enabled": false
}
```

---

## âœ… ç©ºæ•°æ®å¤„ç†è§„èŒƒ

### æ­£ç¡®ç¤ºä¾‹ï¼ˆå·²å®ç°ï¼‰

#### 1. äº¤æ˜“å†å²ä¸ºç©º
```bash
GET /api/transactions/history
```
```json
{
  "items": [],
  "total": 0,
  "page": 0,
  "page_size": 20
}
```
**çŠ¶æ€ç **: 200 âœ…

#### 2. é’±åŒ…äº¤æ˜“ä¸ºç©º
```bash
GET /api/wallets/w1/transactions
```
```json
{
  "wallet_id": "w1",
  "transactions": [],
  "total": 0,
  "message": "é’±åŒ…æš‚æ— äº¤æ˜“è®°å½•",
  "timestamp": "2025-10-29T..."
}
```
**çŠ¶æ€ç **: 200 âœ…

#### 3. é’±åŒ…ä½™é¢ä¸º0
```bash
GET /api/wallets/w1/balance?network=unknown
```
```json
{
  "balance": "0.0",
  "network": "unknown",
  "wallet_id": "w1",
  "timestamp": "2025-10-29T..."
}
```
**çŠ¶æ€ç **: 200 âœ…

### é”™è¯¯ç¤ºä¾‹ï¼ˆå·²é¿å…ï¼‰

âŒ **ä¸è¦è¿™æ ·åš**:
```json
GET /api/transactions/history (æ— æ•°æ®æ—¶)
â†’ 404 {"error": "No transactions found"}
```

âœ… **åº”è¯¥è¿™æ ·åš**:
```json
GET /api/transactions/history (æ— æ•°æ®æ—¶)
â†’ 200 {"items": [], "total": 0}
```

---

## ğŸ”‘ é‰´æƒè§„èŒƒ

### æ”¯æŒçš„é‰´æƒæ–¹å¼

#### æ–¹å¼1: Authorization å¤´
```bash
curl -H "Authorization: Bearer YOUR_API_KEY" \
  http://localhost:8888/api/wallets
```

#### æ–¹å¼2: X-API-Key å¤´
```bash
curl -H "X-API-Key: YOUR_API_KEY" \
  http://localhost:8888/api/wallets
```

### å½“å‰çŠ¶æ€
- âœ… ä»£ç å·²æ”¯æŒé‰´æƒ
- âœ… é»˜è®¤å…³é—­ï¼ˆ`api_key: None`ï¼‰
- âœ… å¯åœ¨å¯åŠ¨æ—¶å¯ç”¨

---

## ğŸ“ é”™è¯¯æ¶ˆæ¯è§„èŒƒ

### å‹å¥½çš„é”™è¯¯æ¶ˆæ¯ï¼ˆå·²å®ç°ï¼‰

#### 404 - èµ„æºä¸å­˜åœ¨
```json
{
  "error": "Wallet not found",
  "message": "é’±åŒ… 'w999' ä¸å­˜åœ¨ï¼Œè¯·æ£€æŸ¥é’±åŒ…IDæ˜¯å¦æ­£ç¡®",
  "wallet_id": "w999"
}
```

#### 401 - æœªæˆæƒ
```json
{
  "error": "Unauthorized",
  "message": "Valid API key required"
}
```

#### 501 - åŠŸèƒ½æœªå®ç°
```json
{
  "error": "Not implemented",
  "message": "æ­¤åŠŸèƒ½å³å°†ä¸Šçº¿",
  "enabled": false
}
```

**åŸåˆ™**: 
- âœ… æä¾›å¯è¯»çš„ä¸­æ–‡æ¶ˆæ¯
- âœ… åŒ…å«å…·ä½“çš„é”™è¯¯åŸå› 
- âœ… ç»™å‡ºä¿®å¤å»ºè®®
- âœ… è¿”å›ç›¸å…³çš„ä¸Šä¸‹æ–‡ä¿¡æ¯

---

## ğŸ¯ å‰ç«¯å‹å¥½è®¾è®¡

### 1. ä¸€è‡´çš„å“åº”ç»“æ„

#### æˆåŠŸå“åº”
```json
{
  "data": [...],        // å®é™…æ•°æ®
  "total": 0,           // å¯é€‰ï¼šæ€»æ•°
  "message": "...",     // å¯é€‰ï¼šè¯´æ˜ä¿¡æ¯
  "timestamp": "..."    // å¯é€‰ï¼šæ—¶é—´æˆ³
}
```

#### é”™è¯¯å“åº”
```json
{
  "error": "Error type",
  "message": "å…·ä½“çš„é”™è¯¯è¯´æ˜",
  "context": {...}      // å¯é€‰ï¼šé”™è¯¯ä¸Šä¸‹æ–‡
}
```

### 2. ç©ºæ•°æ®é™é»˜å¤„ç†

âœ… **é’±åŒ…åˆ—è¡¨ä¸ºç©º** â†’ `200 []`  
âœ… **äº¤æ˜“å†å²ä¸ºç©º** â†’ `200 {"items":[],"total":0}`  
âœ… **ä½™é¢ä¸º0** â†’ `200 {"balance":"0.0"}`  

å‰ç«¯å¯ä»¥ç›´æ¥æ˜¾ç¤º"æš‚æ— æ•°æ®"ï¼Œæ— éœ€ç‰¹æ®Šé”™è¯¯å¤„ç†ã€‚

### 3. åŠŸèƒ½å¼€å…³

å¯¹äºæœªå¼€é€šçš„åŠŸèƒ½ï¼š
```json
{
  "enabled": false,
  "message": "æ­¤åŠŸèƒ½å³å°†ä¸Šçº¿",
  "estimated_release": "2025-11-01"
}
```

å‰ç«¯å¯ä»¥ç°æ˜¾åŠŸèƒ½æŒ‰é’®ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºé”™è¯¯ã€‚

---

## ğŸ“Š å·²å®ç°çš„ç«¯ç‚¹æ±‡æ€»

| ç«¯ç‚¹ | ç©ºæ•°æ®å¤„ç† | èµ„æºä¸å­˜åœ¨ | çŠ¶æ€ |
|------|-----------|----------|------|
| `GET /api/health` | N/A | N/A | âœ… |
| `GET /api/wallets` | 200 `[]` | N/A | âœ… |
| `GET /api/wallets/{id}/balance` | 200 `"0.0"` | 404 + message | âœ… |
| `GET /api/wallets/{id}/transactions` | 200 `[]` | 404 + message | âœ… |
| `GET /api/transactions/history` | 200 `{"items":[]}` | N/A | âœ… |
| `POST /api/transactions/send` | N/A | N/A | âœ… |
| `POST /api/bridge/assets` | N/A | N/A | âœ… |
| `GET /api/anomaly-detection/stats` | 200 `{"total":0}` | N/A | âœ… |

---

## ğŸš€ é‡å¯æœåŠ¡å™¨åº”ç”¨æ›´æ”¹

**è¯·è¿è¡Œ**:
```bash
å¿«é€Ÿé‡å¯APIæœåŠ¡å™¨.bat
```

è¿™ä¼šï¼š
1. âœ… å…³é—­æ—§æœåŠ¡å™¨
2. âœ… é‡æ–°ç¼–è¯‘
3. âœ… å¯åŠ¨æ–°æœåŠ¡å™¨ï¼ˆåŒ…å«æ‰€æœ‰ä¼˜åŒ–ï¼‰

---

## âœ… å‰ç«¯éªŒè¯æ¸…å•

æœåŠ¡å™¨é‡å¯åï¼ŒéªŒè¯ï¼š

- [ ] `GET /api/health` â†’ 200ï¼Œæ¶ˆé™¤404å™ªå£°
- [ ] `GET /api/wallets` â†’ 200 + é’±åŒ…åˆ—è¡¨
- [ ] `GET /api/wallets/w1/balance` â†’ 200 + ä½™é¢
- [ ] `GET /api/wallets/w999/balance` â†’ 404 + å‹å¥½é”™è¯¯æ¶ˆæ¯
- [ ] `GET /api/transactions/history` â†’ 200 + äº¤æ˜“åˆ—è¡¨ï¼ˆå¯ä¸ºç©ºï¼‰
- [ ] æ‰€æœ‰é¡µé¢æ— 404æ°”æ³¡
- [ ] é¡¶éƒ¨çŠ¶æ€æ˜¾ç¤º"API æ­£å¸¸"

---

**ğŸ‰ APIè®¾è®¡æœ€ä½³å®è·µå·²å…¨éƒ¨å®ç°ï¼**

**ä¸‹ä¸€æ­¥**: è¿è¡Œ `å¿«é€Ÿé‡å¯APIæœåŠ¡å™¨.bat` å¹¶éªŒè¯å‰ç«¯ï¼

