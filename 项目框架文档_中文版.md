# ğŸ—ï¸ Rust åŒºå—é“¾å®‰å…¨é’±åŒ… - é¡¹ç›®æ¡†æ¶æ–‡æ¡£

> **ç‰ˆæœ¬**: v0.3.0  
> **æ›´æ–°æ—¥æœŸ**: 2024-11-13  
> **æ–‡æ¡£ç±»å‹**: é¡¹ç›®æ¶æ„ä¸æ¨¡å—è¯´æ˜

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
3. [é¡¹ç›®æ¶æ„](#é¡¹ç›®æ¶æ„)
4. [æ ¸å¿ƒæ¨¡å—è¯¦è§£](#æ ¸å¿ƒæ¨¡å—è¯¦è§£)
5. [æ•°æ®æµå‘](#æ•°æ®æµå‘)
6. [å®‰å…¨æ¶æ„](#å®‰å…¨æ¶æ„)
7. [éƒ¨ç½²æ¶æ„](#éƒ¨ç½²æ¶æ„)
8. [å¼€å‘è§„èŒƒ](#å¼€å‘è§„èŒƒ)

---

## é¡¹ç›®æ¦‚è¿°

### é¡¹ç›®å®šä½

è¿™æ˜¯ä¸€ä¸ª**ä¼ä¸šçº§ã€ç”Ÿäº§å°±ç»ª**çš„åŒºå—é“¾é’±åŒ…åç«¯æœåŠ¡ï¼ŒåŸºäº Rust è¯­è¨€å¼€å‘ï¼Œæä¾›ï¼š

- âœ… **å¤šé“¾æ”¯æŒ**: Ethereum, Bitcoin, Polygon, BSC ç­‰ä¸»æµåŒºå—é“¾
- âœ… **éæ‰˜ç®¡æ¨¡å¼**: ç”¨æˆ·å®Œå…¨æŒæ§ç§é’¥ï¼Œåç«¯ä»…å­˜å‚¨å…¬é’¥åœ°å€
- âœ… **ä¼ä¸šçº§å®‰å…¨**: AES-256-GCM åŠ å¯†ã€Argon2id å¯†ç å“ˆå¸Œã€ç¡¬ä»¶é’±åŒ…é›†æˆ
- âœ… **RESTful API**: å®Œæ•´çš„ HTTP APIï¼Œæ”¯æŒå‰ç«¯/ç§»åŠ¨ç«¯é›†æˆ
- âœ… **é«˜æ€§èƒ½**: å¼‚æ­¥ I/O (Tokio)ã€è¿æ¥æ± ã€é€Ÿç‡é™åˆ¶
- âœ… **å¯æ‰©å±•**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒæ’ä»¶ç³»ç»Ÿ

### æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | è¯´æ˜ |
|------|------|
| **é’±åŒ…ç®¡ç†** | BIP39 åŠ©è®°è¯ç”Ÿæˆã€BIP32/44 å¯†é’¥æ´¾ç”Ÿã€å¤šç­¾é’±åŒ… |
| **äº¤æ˜“å¤„ç†** | å‘é€äº¤æ˜“ã€äº¤æ˜“å†å²æŸ¥è¯¢ã€Nonce ç®¡ç†ã€Gas ä¼°ç®— |
| **è·¨é“¾æ¡¥æ¥** | æ”¯æŒ Li.Fi ç­‰æ¡¥æ¥åè®®ï¼Œå®ç°èµ„äº§è·¨é“¾è½¬ç§» |
| **ç”¨æˆ·è®¤è¯** | JWT Tokenã€Session ç®¡ç†ã€OAuth 2.0 é›†æˆ |
| **å®‰å…¨å®¡è®¡** | æ“ä½œæ—¥å¿—ã€å®¡è®¡è¿½è¸ªã€å¼‚å¸¸æ£€æµ‹ |
| **ç›‘æ§æŒ‡æ ‡** | Prometheus æŒ‡æ ‡ã€å¥åº·æ£€æŸ¥ã€æ€§èƒ½ç›‘æ§ |

---

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶

```toml
[dependencies]
# å¼‚æ­¥è¿è¡Œæ—¶
tokio = { version = "1", features = ["rt-multi-thread", "macros", "time"] }

# Web æ¡†æ¶
axum = { version = "0.7", features = ["ws"] }
tower = { version = "0.4", features = ["util", "limit", "timeout"] }
tower-http = { version = "0.5", features = ["limit", "trace", "cors"] }

# åŒºå—é“¾äº¤äº’
ethers = { version = "2.0.14", features = ["abigen", "rustls"] }
bitcoin = { version = "0.31" }

# å¯†ç å­¦
aes-gcm = "0.10"                    # AES-256-GCM åŠ å¯†
argon2 = "0.5.3"                    # å¯†ç å“ˆå¸Œ
secp256k1 = { version = "0.27", features = ["recovery"] }
ed25519-dalek = "2.1"              # Ed25519 ç­¾å

# æ•°æ®åº“
sqlx = { version = "0.8.6", features = ["sqlite", "postgres", "macros"] }

# åºåˆ—åŒ–
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
```

### å¼€å‘å·¥å…·

| å·¥å…· | ç”¨é€” |
|------|------|
| `cargo` | æ„å»ºå·¥å…· |
| `rustfmt` | ä»£ç æ ¼å¼åŒ– |
| `clippy` | ä»£ç æ£€æŸ¥ |
| `cargo-tarpaulin` | æµ‹è¯•è¦†ç›–ç‡ |
| `cargo-deny` | ä¾èµ–å®¡è®¡ |

---

## é¡¹ç›®æ¶æ„

### æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å®¢æˆ·ç«¯å±‚ (Clients)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Web å‰ç«¯     â”‚  â”‚  ç§»åŠ¨ç«¯ App   â”‚  â”‚  ç¬¬ä¸‰æ–¹é›†æˆ   â”‚         â”‚
â”‚  â”‚  (React)     â”‚  â”‚  (React Native)â”‚ â”‚  (API)       â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ HTTP/HTTPS
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         API ç½‘å…³å±‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Axum Web Server + CORS + Rate Limiting + Timeout        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä¸­é—´ä»¶å±‚ (Middleware)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  è®¤è¯ä¸­é—´ä»¶   â”‚  â”‚  æ—¥å¿—ä¸­é—´ä»¶   â”‚  â”‚  å®‰å…¨ä¸­é—´ä»¶   â”‚           â”‚
â”‚  â”‚  (JWT/Session)â”‚ â”‚  (Tracing)   â”‚  â”‚  (CSP/CSRF) â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ä¸šåŠ¡é€»è¾‘å±‚ (Handlers)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ é’±åŒ…ç®¡ç†     â”‚  â”‚ äº¤æ˜“å¤„ç†     â”‚  â”‚ ç”¨æˆ·è®¤è¯     â”‚           â”‚
â”‚  â”‚ handlers/    â”‚  â”‚ handlers/    â”‚  â”‚ auth_simple â”‚           â”‚
â”‚  â”‚ wallet.rs    â”‚  â”‚ transaction.rsâ”‚ â”‚             â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ è·¨é“¾æ¡¥æ¥     â”‚  â”‚ NFT ç®¡ç†     â”‚  â”‚ GameFi      â”‚           â”‚
â”‚  â”‚ bridge/      â”‚  â”‚ nft/         â”‚  â”‚ gamefi/     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ ¸å¿ƒæœåŠ¡å±‚ (Core)                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ WalletManagerâ”‚  â”‚  å¯†é’¥ç®¡ç†     â”‚  â”‚  åŠ å¯†æœåŠ¡    â”‚           â”‚
â”‚  â”‚ (é’±åŒ…ç®¡ç†å™¨)  â”‚  â”‚  key_mgmt    â”‚  â”‚  crypto/     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     åŒºå—é“¾äº¤äº’å±‚ (Blockchain)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ EthereumClientâ”‚ â”‚ BitcoinClientâ”‚ â”‚ BridgeClient â”‚           â”‚
â”‚  â”‚ (Ethers.rs)  â”‚  â”‚ (Bitcoin)    â”‚  â”‚ (Li.Fi)      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       æ•°æ®æŒä¹…å±‚ (Storage)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Wallet DB    â”‚  â”‚ User DB     â”‚  â”‚ Session Storeâ”‚           â”‚
â”‚  â”‚ (SQLite)     â”‚  â”‚ (SQLite)    â”‚  â”‚ (Memory)     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å¤–éƒ¨æœåŠ¡å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ RPC èŠ‚ç‚¹     â”‚  â”‚ åŒºå—æµè§ˆå™¨   â”‚  â”‚ ä»·æ ¼é¢„è¨€æœº   â”‚           â”‚
â”‚  â”‚ (Infura/Alchemy)â”‚ (Etherscan) â”‚  â”‚ (CoinGecko) â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç›®å½•ç»“æ„

```
Rust-Blockchain-Secure-Wallet/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.rs                    # ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ lib.rs                     # åº“å…¥å£
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                       # API å±‚
â”‚   â”‚   â”œâ”€â”€ server.rs              # Axum æœåŠ¡å™¨
â”‚   â”‚   â”œâ”€â”€ handlers/              # è¯·æ±‚å¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ wallet.rs          # é’±åŒ…ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ transaction.rs     # äº¤æ˜“å¤„ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ balance.rs         # ä½™é¢æŸ¥è¯¢
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â”œâ”€â”€ middleware/            # ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.rs            # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ rate_limit.rs      # é€Ÿç‡é™åˆ¶
â”‚   â”‚   â”‚   â””â”€â”€ logging.rs         # æ—¥å¿—è®°å½•
â”‚   â”‚   â”œâ”€â”€ auth_simple.rs         # ç®€åŒ–è®¤è¯æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ user_db.rs             # ç”¨æˆ·æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ session_store.rs       # ä¼šè¯å­˜å‚¨
â”‚   â”‚   â””â”€â”€ types.rs               # API ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ core/                      # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ config.rs              # é…ç½®ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ errors.rs              # é”™è¯¯ç±»å‹
â”‚   â”‚   â”œâ”€â”€ wallet_info.rs         # é’±åŒ…ä¿¡æ¯ç»“æ„
â”‚   â”‚   â”œâ”€â”€ key_management.rs      # å¯†é’¥ç®¡ç†
â”‚   â”‚   â””â”€â”€ wallet_manager/        # é’±åŒ…ç®¡ç†å™¨
â”‚   â”‚       â”œâ”€â”€ mod.rs             # æ¨¡å—å…¥å£
â”‚   â”‚       â”œâ”€â”€ lifecycle.rs       # ç”Ÿå‘½å‘¨æœŸç®¡ç†
â”‚   â”‚       â”œâ”€â”€ keys.rs            # å¯†é’¥æ“ä½œ
â”‚   â”‚       â”œâ”€â”€ transactions.rs    # äº¤æ˜“æ“ä½œ
â”‚   â”‚       â”œâ”€â”€ balance.rs         # ä½™é¢æŸ¥è¯¢
â”‚   â”‚       â”œâ”€â”€ backup.rs          # å¤‡ä»½æ¢å¤
â”‚   â”‚       â”œâ”€â”€ bridge.rs          # è·¨é“¾æ¡¥æ¥
â”‚   â”‚       â”œâ”€â”€ derivation.rs      # å¯†é’¥æ´¾ç”Ÿ
â”‚   â”‚       â””â”€â”€ signing.rs         # äº¤æ˜“ç­¾å
â”‚   â”‚
â”‚   â”œâ”€â”€ blockchain/                # åŒºå—é“¾å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ traits.rs              # é€šç”¨æ¥å£
â”‚   â”‚   â”œâ”€â”€ ethereum.rs            # Ethereum å®¢æˆ·ç«¯
â”‚   â”‚   â”œâ”€â”€ bitcoin/               # Bitcoin å®¢æˆ·ç«¯
â”‚   â”‚   â”‚   â”œâ”€â”€ client.rs
â”‚   â”‚   â”‚   â”œâ”€â”€ transaction.rs
â”‚   â”‚   â”‚   â””â”€â”€ utxo.rs
â”‚   â”‚   â””â”€â”€ bridge/                # è·¨é“¾æ¡¥æ¥
â”‚   â”‚       â”œâ”€â”€ lifi.rs            # Li.Fi é›†æˆ
â”‚   â”‚       â””â”€â”€ types.rs
â”‚   â”‚
â”‚   â”œâ”€â”€ crypto/                    # å¯†ç å­¦æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ encryption_consistency.rs  # åŠ å¯†ä¸€è‡´æ€§éªŒè¯
â”‚   â”‚   â”œâ”€â”€ kdf.rs                 # å¯†é’¥æ´¾ç”Ÿ (PBKDF2/Scrypt/HKDF)
â”‚   â”‚   â”œâ”€â”€ quantum.rs             # é‡å­å®‰å…¨åŠ å¯†
â”‚   â”‚   â”œâ”€â”€ multisig/              # å¤šç­¾åŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ shamir.rs              # Shamir ç§˜å¯†å…±äº«
â”‚   â”‚   â””â”€â”€ signature_utils.rs     # ç­¾åå·¥å…·
â”‚   â”‚
â”‚   â”œâ”€â”€ security/                  # å®‰å…¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ encryption.rs          # åŠ å¯†æ“ä½œ
â”‚   â”‚   â”œâ”€â”€ memory_protection.rs   # å†…å­˜ä¿æŠ¤
â”‚   â”‚   â”œâ”€â”€ password_validator.rs  # å¯†ç éªŒè¯
â”‚   â”‚   â”œâ”€â”€ env_validator.rs       # ç¯å¢ƒå˜é‡éªŒè¯
â”‚   â”‚   â”œâ”€â”€ secret.rs              # æ•æ„Ÿæ•°æ®åŒ…è£…
â”‚   â”‚   â”œâ”€â”€ anti_debug.rs          # åè°ƒè¯•
â”‚   â”‚   â””â”€â”€ env_manager/           # ç¯å¢ƒç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ auth/                      # è®¤è¯æˆæƒ
â”‚   â”‚   â”œâ”€â”€ service.rs             # è®¤è¯æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ types.rs               # è®¤è¯ç±»å‹
â”‚   â”‚   â”œâ”€â”€ core/                  # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”‚   â”‚   â”œâ”€â”€ user_service.rs    # ç”¨æˆ·æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ token_service.rs   # Token æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ password_service.rs # å¯†ç æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ storage/               # å­˜å‚¨å±‚
â”‚   â”‚   â””â”€â”€ providers/             # OAuth æä¾›è€…
â”‚   â”‚
â”‚   â”œâ”€â”€ storage/                   # å­˜å‚¨å±‚
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â””â”€â”€ sqlite.rs              # SQLite å®ç°
â”‚   â”‚
â”‚   â”œâ”€â”€ audit/                     # å®¡è®¡æ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ logging.rs             # æ“ä½œæ—¥å¿—
â”‚   â”‚   â”œâ”€â”€ alert.rs               # å‘Šè­¦ç³»ç»Ÿ
â”‚   â”‚   â””â”€â”€ rollback.rs            # å›æ»šæœºåˆ¶
â”‚   â”‚
â”‚   â”œâ”€â”€ monitoring/                # ç›‘æ§æ¨¡å—
â”‚   â”‚   â””â”€â”€ metrics.rs             # Prometheus æŒ‡æ ‡
â”‚   â”‚
â”‚   â”œâ”€â”€ network/                   # ç½‘ç»œæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ rate_limit.rs          # é€Ÿç‡é™åˆ¶
â”‚   â”‚   â””â”€â”€ node_manager.rs        # èŠ‚ç‚¹ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ ops/                       # è¿ç»´æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ health.rs              # å¥åº·æ£€æŸ¥
â”‚   â”‚   â”œâ”€â”€ backup.rs              # å¤‡ä»½ç®¡ç†
â”‚   â”‚   â””â”€â”€ metrics.rs             # æŒ‡æ ‡æ”¶é›†
â”‚   â”‚
â”‚   â””â”€â”€ bin/                       # å¯æ‰§è¡Œç¨‹åº
â”‚       â”œâ”€â”€ wallet-cli.rs          # CLI å·¥å…·
â”‚       â””â”€â”€ bridge_test.rs         # æ¡¥æ¥æµ‹è¯•
â”‚
â”œâ”€â”€ tests/                         # é›†æˆæµ‹è¯•
â”‚   â”œâ”€â”€ api_server_tests.rs        # API æµ‹è¯•
â”‚   â”œâ”€â”€ wallet_manager_tests.rs    # é’±åŒ…ç®¡ç†å™¨æµ‹è¯•
â”‚   â”œâ”€â”€ security_tests.rs          # å®‰å…¨æµ‹è¯•
â”‚   â””â”€â”€ ...                        # 140+ æµ‹è¯•æ–‡ä»¶
â”‚
â”œâ”€â”€ migrations/                    # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ users/
â”‚       â””â”€â”€ 001_create_users_table.sql
â”‚
â”œâ”€â”€ config.toml                    # é…ç½®æ–‡ä»¶
â”œâ”€â”€ Cargo.toml                     # Rust é¡¹ç›®é…ç½®
â”œâ”€â”€ Dockerfile                     # Docker é•œåƒ
â””â”€â”€ docs/                          # æ–‡æ¡£ç›®å½•
```

---

## æ ¸å¿ƒæ¨¡å—è¯¦è§£

### 1. API å±‚ (`src/api/`)

**èŒè´£**: å¤„ç† HTTP è¯·æ±‚ï¼Œæä¾› RESTful API

#### ä¸»è¦ç»„ä»¶

##### 1.1 æœåŠ¡å™¨ (`server.rs`)

```rust
pub struct WalletServer {
    pub wallet_manager: Arc<WalletManager>,       // é’±åŒ…ç®¡ç†å™¨
    pub user_db: Arc<UserDatabase>,               // ç”¨æˆ·æ•°æ®åº“
    pub session_store: Arc<SessionStore>,         // ä¼šè¯å­˜å‚¨
    pub rate_limiter: Arc<RateLimiter>,           // é€Ÿç‡é™åˆ¶å™¨
    pub host: String,
    pub port: u16,
    pub config: WalletConfig,
}
```

**å…³é”®åŠŸèƒ½**:
- âœ… Axum æ¡†æ¶é©±åŠ¨çš„å¼‚æ­¥ HTTP æœåŠ¡å™¨
- âœ… CORS é…ç½® (æ”¯æŒè·¨åŸŸè¯·æ±‚)
- âœ… è¯·æ±‚è¶…æ—¶ä¿æŠ¤ (30 ç§’)
- âœ… å¹¶å‘é™åˆ¶ (æœ€å¤§ 100 å¹¶å‘)
- âœ… è¯·æ±‚ä½“å¤§å°é™åˆ¶ (5MB)
- âœ… é€Ÿç‡é™åˆ¶ (100 è¯·æ±‚/åˆ†é’Ÿ/IP)

##### 1.2 è¯·æ±‚å¤„ç†å™¨ (`handlers/`)

| æ–‡ä»¶ | åŠŸèƒ½ | ä¸»è¦æ¥å£ |
|------|------|----------|
| `wallet.rs` | é’±åŒ…ç®¡ç† | åˆ›å»ºã€åˆ é™¤ã€åˆ—è¡¨ã€æŸ¥è¯¢åœ°å€ |
| `transaction.rs` | äº¤æ˜“å¤„ç† | å‘é€äº¤æ˜“ã€æŸ¥è¯¢å†å²ã€æ£€æŸ¥çŠ¶æ€ |
| `balance.rs` | ä½™é¢æŸ¥è¯¢ | æŸ¥è¯¢å•é“¾/å¤šé“¾ä½™é¢ |
| `backup.rs` | å¤‡ä»½æ¢å¤ | å¯¼å‡ºåŠ©è®°è¯ã€æ¢å¤é’±åŒ… |
| `system_info.rs` | ç³»ç»Ÿä¿¡æ¯ | ç‰ˆæœ¬ã€çŠ¶æ€ã€é…ç½® |

**ç¤ºä¾‹: åˆ›å»ºé’±åŒ…å¤„ç†å™¨**

```rust
pub async fn create_wallet(
    State(state): State<Arc<WalletServer>>,
    headers: HeaderMap,
    Json(payload): Json<CreateWalletRequest>,
) -> Result<Json<WalletResponse>, (StatusCode, Json<ErrorResponse>)> {
    // 1. éªŒè¯ç”¨æˆ·èº«ä»½
    let user_id = extract_user_id_from_token(&headers, &state).await?;
    
    // 2. éªŒè¯è¾“å…¥å‚æ•°
    validate_wallet_name(&payload.name)?;
    validate_wallet_address(&payload.wallet_address)?;
    
    // 3. é“¾æ¥é’±åŒ…åˆ°ç”¨æˆ·
    state.user_db.link_wallet(&user_id, &payload.name, &payload.wallet_address).await?;
    
    // 4. è¿”å›ç»“æœ
    Ok(Json(WalletResponse { ... }))
}
```

##### 1.3 ä¸­é—´ä»¶ (`middleware/`)

```rust
// è®¤è¯ä¸­é—´ä»¶
pub async fn extract_user_id_from_token(
    headers: &HeaderMap,
    state: &WalletServer,
) -> Result<String, AuthError> {
    // 1. æå– JWT Token
    // 2. éªŒè¯ç­¾å
    // 3. æ£€æŸ¥è¿‡æœŸæ—¶é—´
    // 4. è¿”å›ç”¨æˆ· ID
}

// é€Ÿç‡é™åˆ¶ä¸­é—´ä»¶
pub struct RateLimiter {
    limiter: Arc<GovernorRateLimiter<...>>,
}
```

### 2. æ ¸å¿ƒå±‚ (`src/core/`)

**èŒè´£**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œä¸ä¾èµ–å…·ä½“çš„ä¼ è¾“åè®®

#### 2.1 é’±åŒ…ç®¡ç†å™¨ (`wallet_manager/`)

```rust
pub struct WalletManager {
    pub config: WalletConfig,
    pub wallets: Arc<RwLock<HashMap<String, SecureWalletData>>>,
    pub nonce_tracker: Arc<RwLock<HashMap<String, HashMap<String, u64>>>>,
    pub bridge_transactions: Arc<RwLock<HashMap<String, BridgeTransaction>>>,
}
```

**å­æ¨¡å—åˆ’åˆ†**:

| æ¨¡å— | æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|------|
| **ç”Ÿå‘½å‘¨æœŸ** | `lifecycle.rs` | åˆ›å»ºã€åˆ é™¤ã€åˆ—è¡¨é’±åŒ… |
| **å¯†é’¥ç®¡ç†** | `keys.rs` | å¯†é’¥ç”Ÿæˆã€æ´¾ç”Ÿã€è½®æ¢ |
| **äº¤æ˜“æ“ä½œ** | `transactions.rs` | å‘é€äº¤æ˜“ã€å¤šç­¾äº¤æ˜“ |
| **ä½™é¢æŸ¥è¯¢** | `balance.rs` | æŸ¥è¯¢ä½™é¢ã€èµ„äº§åˆ—è¡¨ |
| **å¤‡ä»½æ¢å¤** | `backup.rs` | å¯¼å‡ºåŠ©è®°è¯ã€æ¢å¤é’±åŒ… |
| **è·¨é“¾æ¡¥æ¥** | `bridge.rs` | è·¨é“¾è½¬è´¦ã€çŠ¶æ€æŸ¥è¯¢ |
| **åœ°å€æ´¾ç”Ÿ** | `derivation.rs` | BIP44 åœ°å€æ´¾ç”Ÿ |
| **äº¤æ˜“ç­¾å** | `signing.rs` | Ethereum äº¤æ˜“ç­¾å |

**æ ¸å¿ƒæµç¨‹: åˆ›å»ºé’±åŒ…**

```rust
pub async fn create_wallet(
    &self,
    name: &str,
    password: &str,
    quantum_safe: bool,
) -> Result<(), WalletError> {
    // 1. æ£€æŸ¥é’±åŒ…æ˜¯å¦å·²å­˜åœ¨
    if self.wallets.read().contains_key(name) {
        return Err(WalletError::ValidationError(...));
    }
    
    // 2. ç”Ÿæˆ BIP39 åŠ©è®°è¯ (24 words)
    let mut entropy = [0u8; 32];
    rand::thread_rng().fill_bytes(&mut entropy);
    let mnemonic = Mnemonic::from_entropy_in(Language::English, &entropy)?;
    
    // 3. ä»åŠ©è®°è¯æ´¾ç”Ÿç§å­
    let seed = mnemonic.to_seed("");
    
    // 4. ä½¿ç”¨ PBKDF2 ä»å¯†ç æ´¾ç”ŸåŠ å¯†å¯†é’¥
    let mut salt = [0u8; 32];
    rand::thread_rng().fill_bytes(&mut salt);
    let mut key = [0u8; 32];
    pbkdf2_hmac::<Sha256>(password.as_bytes(), &salt, 100_000, &mut key);
    
    // 5. ä½¿ç”¨ AES-256-GCM åŠ å¯†ä¸»å¯†é’¥
    let cipher = Aes256Gcm::new_from_slice(&key)?;
    let nonce = generate_nonce();
    let encrypted_master_key = cipher.encrypt(&nonce, seed.as_ref())?;
    
    // 6. åˆ›å»ºé’±åŒ…æ•°æ®ç»“æ„
    let wallet_data = SecureWalletData {
        info: WalletInfo { ... },
        encrypted_master_key,
        salt: salt.to_vec(),
        nonce: nonce.to_vec(),
        ...
    };
    
    // 7. å­˜å‚¨åˆ°å†…å­˜
    self.wallets.write().insert(name.to_string(), wallet_data);
    
    Ok(())
}
```

#### 2.2 é…ç½®ç®¡ç† (`config.rs`)

```rust
#[derive(Debug, Clone, Serialize, Deserialize)]
pub struct WalletConfig {
    pub storage: StorageConfig,          // æ•°æ®åº“é…ç½®
    pub blockchain: BlockchainConfig,     // åŒºå—é“¾ç½‘ç»œé…ç½®
    pub security: SecurityConfig,         // å®‰å…¨é…ç½®
    pub quantum_safe: bool,               // é‡å­å®‰å…¨æ¨¡å¼
    pub multi_sig_threshold: u8,          // å¤šç­¾é˜ˆå€¼
    pub derivation: DerivationConfig,     // æ´¾ç”Ÿè·¯å¾„é…ç½®
}

#[derive(Debug, Clone)]
pub struct SecurityConfig {
    pub pbkdf2_iterations: u32,           // PBKDF2 è¿­ä»£æ¬¡æ•° (é»˜è®¤ 100,000)
    pub bcrypt_cost: u32,                 // bcrypt æˆæœ¬å› å­ (é»˜è®¤ 12)
    pub session_timeout: u64,             // ä¼šè¯è¶…æ—¶ (ç§’)
    pub max_sessions_per_user: usize,     // æ¯ç”¨æˆ·æœ€å¤§ä¼šè¯æ•°
    pub csrf_token_ttl: u64,              // CSRF Token æœ‰æ•ˆæœŸ
    pub rate_limiter_max_entries: usize,  // é€Ÿç‡é™åˆ¶æœ€å¤§æ¡ç›®æ•°
}
```

### 3. åŒºå—é“¾å±‚ (`src/blockchain/`)

**èŒè´£**: ä¸å„åŒºå—é“¾ç½‘ç»œäº¤äº’

#### 3.1 é€šç”¨æ¥å£ (`traits.rs`)

```rust
#[async_trait]
pub trait BlockchainClient: Send + Sync {
    fn clone_box(&self) -> Box<dyn BlockchainClient>;
    
    async fn get_balance(&self, address: &str) -> Result<String, WalletError>;
    
    async fn send_transaction(
        &self,
        private_key: &PrivateKey,
        to_address: &str,
        amount: &str,
    ) -> Result<String, WalletError>;
    
    async fn get_transaction_status(
        &self, 
        tx_hash: &str
    ) -> Result<TransactionStatus, WalletError>;
    
    async fn estimate_fee(&self, to_address: &str, amount: &str) -> Result<String, WalletError>;
    
    async fn get_nonce(&self, address: &str) -> Result<u64, WalletError>;
    
    fn validate_address(&self, address: &str) -> Result<bool>;
    
    fn get_network_name(&self) -> &str;
    fn get_native_token(&self) -> &str;
}
```

#### 3.2 Ethereum å®¢æˆ·ç«¯ (`ethereum.rs`)

```rust
pub struct EthereumClient<P: JsonRpcClient = Http> {
    provider: Provider<P>,
    network_name: String,
    chain_id: u64,
}

impl EthereumClient<Http> {
    pub async fn new(rpc_url: &str) -> Result<Self> {
        let provider = Provider::<Http>::try_from(rpc_url)?;
        let chain_id = provider.get_chainid().await?.as_u64();
        
        Ok(Self { provider, network_name: "ethereum", chain_id })
    }
    
    pub async fn send_eip1559_transaction(
        &self,
        private_key: &[u8],
        to: Address,
        value: U256,
        max_fee_per_gas: U256,
        max_priority_fee_per_gas: U256,
    ) -> Result<TxHash> {
        // 1. åˆ›å»ºé’±åŒ…
        let wallet = LocalWallet::from_bytes(private_key)?.with_chain_id(self.chain_id);
        
        // 2. è·å– nonce
        let nonce = self.provider.get_transaction_count(wallet.address(), None).await?;
        
        // 3. æ„å»º EIP-1559 äº¤æ˜“
        let tx = Eip1559TransactionRequest::new()
            .to(to)
            .value(value)
            .max_fee_per_gas(max_fee_per_gas)
            .max_priority_fee_per_gas(max_priority_fee_per_gas)
            .nonce(nonce)
            .chain_id(self.chain_id);
        
        // 4. ç­¾åå¹¶å‘é€
        let signature = wallet.sign_transaction(&tx).await?;
        let tx_hash = self.provider.send_raw_transaction(signature).await?;
        
        Ok(tx_hash)
    }
}
```

### 4. å¯†ç å­¦å±‚ (`src/crypto/`)

**èŒè´£**: æä¾›åŠ å¯†ã€å¯†é’¥æ´¾ç”Ÿã€ç­¾åç­‰å¯†ç å­¦åŠŸèƒ½

#### 4.1 å¯†é’¥æ´¾ç”Ÿ (`kdf.rs`)

```rust
pub enum KDFAlgorithm {
    PBKDF2 { iterations: u32 },
    Scrypt { n: u32, r: u32, p: u32 },
    HKDF,
}

pub struct KeyDerivation {
    algorithm: KDFAlgorithm,
}

impl KeyDerivation {
    pub fn derive_key(
        &self,
        password: &[u8],
        salt: &[u8],
        key_length: usize,
    ) -> Result<Zeroizing<Vec<u8>>> {
        match &self.algorithm {
            KDFAlgorithm::PBKDF2 { iterations } => {
                let mut key = Zeroizing::new(vec![0u8; key_length]);
                pbkdf2_hmac::<Sha256>(password, salt, *iterations, &mut key);
                Ok(key)
            }
            KDFAlgorithm::Scrypt { n, r, p } => {
                // Scrypt å®ç°
            }
            KDFAlgorithm::HKDF => {
                // HKDF å®ç°
            }
        }
    }
}
```

#### 4.2 é‡å­å®‰å…¨åŠ å¯† (`quantum.rs`)

```rust
pub struct QuantumSafeEncryption {
    keypair: Option<QuantumKeyPair>,
}

impl QuantumSafeEncryption {
    pub fn encrypt(
        &self,
        plaintext: &[u8],
        master_key: &[u8],
    ) -> Result<Zeroizing<Vec<u8>>> {
        // 1. ä½¿ç”¨ HKDF ä»ä¸»å¯†é’¥æ´¾ç”Ÿ AES å¯†é’¥
        let aes_key = self.derive_aes_key(master_key)?;
        
        // 2. AES-256-GCM åŠ å¯†
        let cipher = Aes256Gcm::new_from_slice(&aes_key)?;
        let nonce = generate_nonce();
        let ciphertext = cipher.encrypt(&nonce, plaintext)?;
        
        // 3. æ¨¡æ‹Ÿ Kyber1024 KEM å°è£…
        let kyber_ciphertext = self.simulate_kyber_encapsulation()?;
        
        // 4. ç»„åˆè¾“å‡º: [nonce||aes_ciphertext||kyber_ciphertext]
        let mut result = nonce.to_vec();
        result.extend_from_slice(&ciphertext);
        result.extend_from_slice(&kyber_ciphertext);
        
        Ok(Zeroizing::new(result))
    }
}
```

### 5. å®‰å…¨å±‚ (`src/security/`)

**èŒè´£**: æä¾›å®‰å…¨ç›¸å…³åŠŸèƒ½

#### 5.1 åŠ å¯†æ“ä½œ (`encryption.rs`)

```rust
pub struct WalletSecurity {
    keys: HashMap<String, Zeroizing<Vec<u8>>>,
}

impl WalletSecurity {
    pub fn encrypt(&mut self, data: &[u8], key_id: &str) -> Result<Vec<u8>> {
        // 1. è·å–æˆ–åˆ›å»ºå¯†é’¥
        let key = self.get_or_create_key(key_id)?;
        
        // 2. åˆ›å»º AES-256-GCM å¯†ç å™¨
        let cipher = Aes256Gcm::new_from_slice(&key)?;
        
        // 3. ç”Ÿæˆéšæœº nonce
        let mut nonce_bytes = [0u8; 12];
        rand::thread_rng().fill_bytes(&mut nonce_bytes);
        let nonce = Nonce::from_slice(&nonce_bytes);
        
        // 4. åŠ å¯†
        let ciphertext = cipher.encrypt(nonce, data)?;
        
        // 5. è¾“å‡ºæ ¼å¼: nonce(12) || ciphertext
        let mut result = nonce_bytes.to_vec();
        result.extend_from_slice(&ciphertext);
        
        Ok(result)
    }
    
    pub fn decrypt(&mut self, data: &[u8], key_id: &str) -> Result<Zeroizing<Vec<u8>>> {
        // 1. è§£æ nonce å’Œå¯†æ–‡
        let (nonce_bytes, ciphertext) = data.split_at(12);
        
        // 2. è§£å¯†
        let key = self.get_or_create_key(key_id)?;
        let cipher = Aes256Gcm::new_from_slice(&key)?;
        let nonce = Nonce::from_slice(nonce_bytes);
        let plaintext = cipher.decrypt(nonce, ciphertext)?;
        
        Ok(Zeroizing::new(plaintext))
    }
}
```

#### 5.2 å†…å­˜ä¿æŠ¤ (`memory_protection.rs`)

```rust
pub fn lock_memory(data: &[u8]) -> Result<()> {
    #[cfg(target_os = "linux")]
    {
        unsafe {
            libc::mlock(data.as_ptr() as *const _, data.len());
        }
    }
    
    #[cfg(target_os = "windows")]
    {
        unsafe {
            winapi::um::memoryapi::VirtualLock(
                data.as_ptr() as *mut _,
                data.len(),
            );
        }
    }
    
    Ok(())
}

pub fn unlock_memory(data: &[u8]) -> Result<()> {
    // è§£é”å†…å­˜
}
```

### 6. è®¤è¯å±‚ (`src/auth/`)

**èŒè´£**: ç”¨æˆ·è®¤è¯ä¸æˆæƒ

#### 6.1 è®¤è¯æœåŠ¡ (`service.rs`)

```rust
pub struct AuthService {
    user_service: Arc<UserService>,
    token_service: Arc<TokenService>,
    password_service: Arc<PasswordService>,
    config: AuthConfig,
}

impl AuthService {
    pub async fn register(&self, req: RegisterRequest) -> Result<AuthResponse> {
        // 1. éªŒè¯é‚®ç®±æ ¼å¼
        self.validate_email(&req.email)?;
        
        // 2. éªŒè¯å¯†ç å¼ºåº¦
        self.password_service.validate_strength(&req.password)?;
        
        // 3. å“ˆå¸Œå¯†ç  (Argon2id)
        let password_hash = self.password_service.hash_password(&req.password)?;
        
        // 4. åˆ›å»ºç”¨æˆ·
        let user = self.user_service.create_user(req.email, password_hash).await?;
        
        // 5. ç”Ÿæˆ JWT Token
        let access_token = self.token_service.generate_token(&user.id)?;
        let refresh_token = self.token_service.generate_refresh_token(&user.id)?;
        
        Ok(AuthResponse {
            user,
            access_token,
            refresh_token,
            expires_in: 3600,
        })
    }
    
    pub async fn login(&self, req: LoginRequest) -> Result<AuthResponse> {
        // 1. æŸ¥æ‰¾ç”¨æˆ·
        let user = self.user_service.find_by_email(&req.email).await?
            .ok_or(AuthError::InvalidCredentials)?;
        
        // 2. éªŒè¯å¯†ç 
        let valid = self.user_service.verify_password(&user.email, &req.password).await?;
        if !valid {
            return Err(AuthError::InvalidCredentials);
        }
        
        // 3. æ›´æ–°æœ€åç™»å½•æ—¶é—´
        self.user_service.update_last_login(&user.id).await?;
        
        // 4. ç”Ÿæˆ Token
        let access_token = self.token_service.generate_token(&user.id)?;
        let refresh_token = self.token_service.generate_refresh_token(&user.id)?;
        
        Ok(AuthResponse { ... })
    }
}
```

### 7. æ•°æ®åº“å±‚ (`src/api/user_db.rs`)

**èŒè´£**: ç”¨æˆ·å’Œé’±åŒ…æ•°æ®æŒä¹…åŒ–

```rust
pub struct UserDatabase {
    pool: SqlitePool,
}

impl UserDatabase {
    pub async fn new(database_url: &str) -> Result<Self> {
        // 1. åˆ›å»ºè¿æ¥æ± 
        let pool = SqlitePoolOptions::new()
            .max_connections(5)
            .connect(database_url)
            .await?;
        
        // 2. è¿è¡Œè¿ç§»
        sqlx::query(include_str!("../../migrations/users/001_create_users_table.sql"))
            .execute(&pool)
            .await?;
        
        Ok(Self { pool })
    }
    
    pub async fn create_user(&self, email: &str, password_hash: &str) -> Result<User> {
        let user_id = Uuid::new_v4().to_string();
        
        sqlx::query(
            "INSERT INTO users (id, email, password_hash, created_at) 
             VALUES (?, ?, ?, ?)"
        )
        .bind(&user_id)
        .bind(email)
        .bind(password_hash)
        .bind(Utc::now())
        .execute(&self.pool)
        .await?;
        
        Ok(User { id: user_id, email: email.to_string(), ... })
    }
    
    pub async fn link_wallet(
        &self,
        user_id: &str,
        wallet_name: &str,
        wallet_address: &str,
        wallet_type: Option<&str>,
    ) -> Result<()> {
        sqlx::query(
            "INSERT INTO user_wallets (user_id, wallet_name, wallet_address, wallet_type)
             VALUES (?, ?, ?, ?)"
        )
        .bind(user_id)
        .bind(wallet_name)
        .bind(wallet_address)
        .bind(wallet_type.unwrap_or("standard"))
        .execute(&self.pool)
        .await?;
        
        Ok(())
    }
}
```

---

## æ•°æ®æµå‘

### 1. ç”¨æˆ·æ³¨å†Œæµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   POST /api/auth/register   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚ API      â”‚
â”‚  (React) â”‚   { email, password }        â”‚ Handler  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â†“
                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                          â”‚ AuthServiceâ”‚
                                          â”‚ .register()â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚                       â”‚
                                   â†“                       â†“
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ Password    â”‚      â”‚ User        â”‚
                            â”‚ Service     â”‚      â”‚ Service     â”‚
                            â”‚ .hash()     â”‚      â”‚ .create()   â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚                       â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â†“
                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                          â”‚ User DB  â”‚
                                          â”‚ INSERT   â”‚
                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â†“
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚ Token Service                â”‚
                            â”‚ .generate_token()            â”‚
                            â”‚ (JWT: RS256, expires: 1h)    â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
                                               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          JSON Response       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ API      â”‚
â”‚  (React) â”‚  { user, access_token }      â”‚ Handler  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. åˆ›å»ºé’±åŒ…æµç¨‹ (éæ‰˜ç®¡æ¨¡å¼)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   POST /api/wallets         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>  â”‚ API      â”‚
â”‚  (MetaMask)  { name, address }          â”‚ Handler  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                         â”‚
     â”‚ 1. å‰ç«¯ç”ŸæˆåŠ©è®°è¯                        â”‚
     â”‚ 2. å‰ç«¯æ´¾ç”Ÿç§é’¥                          â”‚
     â”‚ 3. å‰ç«¯æ´¾ç”Ÿåœ°å€                          â”‚
     â”‚                                         â†“
     â”‚                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                  â”‚ æå– JWT â”‚
     â”‚                                  â”‚ è·å– User IDâ”‚
     â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                         â”‚
     â”‚                                         â†“
     â”‚                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                  â”‚ éªŒè¯è¾“å…¥  â”‚
     â”‚                                  â”‚ - Wallet Nameâ”‚
     â”‚                                  â”‚ - Addressâ”‚
     â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                         â”‚
     â”‚                                         â†“
     â”‚                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                  â”‚ User DB  â”‚
     â”‚                                  â”‚ link_wallet()â”‚
     â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                         â”‚
     â”‚                                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          JSON Response       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ API      â”‚
â”‚  (MetaMask)  { id, name, address }       â”‚ Handler  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. å‘é€äº¤æ˜“æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   POST /api/transactions/send  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯     â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ API      â”‚
â”‚  (MetaMask)  { wallet_name, to, amount }   â”‚ Handler  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                            â”‚
     â”‚ å‰ç«¯ç­¾åäº¤æ˜“ (ç§é’¥åœ¨å‰ç«¯)                    â”‚
     â”‚                                            â†“
     â”‚                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                     â”‚ Wallet   â”‚
     â”‚                                     â”‚ Manager  â”‚
     â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                            â”‚
     â”‚                                            â†“
     â”‚                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                     â”‚ Ethereum â”‚
     â”‚                                     â”‚ Client   â”‚
     â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                            â”‚
     â”‚                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                  â”‚                   â”‚
     â”‚                                  â†“                   â†“
     â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                            â”‚ è·å– Nonce â”‚       â”‚ ä¼°ç®— Gas â”‚
     â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                  â”‚                   â”‚
     â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                            â†“
     â”‚                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                     â”‚ æ„å»ºäº¤æ˜“  â”‚
     â”‚                                     â”‚ (EIP-1559)â”‚
     â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                            â”‚
     â”‚                                            â†“
     â”‚                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚                                     â”‚ å‘é€åˆ°RPC â”‚
     â”‚                                     â”‚ èŠ‚ç‚¹      â”‚
     â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚                                            â”‚
     â”‚                                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          JSON Response          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯     â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ API      â”‚
â”‚  (MetaMask)  { tx_hash }                    â”‚ Handler  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å®‰å…¨æ¶æ„

### 1. è®¤è¯ä¸æˆæƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       è®¤è¯å±‚çº§                               â”‚
â”‚                                                             â”‚
â”‚  Level 1: JWT Token                                         â”‚
â”‚  â”œâ”€ ç®—æ³•: RS256 (éå¯¹ç§°åŠ å¯†)                                 â”‚
â”‚  â”œâ”€ è¿‡æœŸæ—¶é—´: 1 å°æ—¶                                         â”‚
â”‚  â”œâ”€ åˆ·æ–°æœºåˆ¶: Refresh Token (7 å¤©)                           â”‚
â”‚  â””â”€ å­˜å‚¨: HTTP-only Cookie + LocalStorage                   â”‚
â”‚                                                             â”‚
â”‚  Level 2: Session ç®¡ç†                                      â”‚
â”‚  â”œâ”€ ä¼šè¯å­˜å‚¨: å†…å­˜ (HashMap)                                 â”‚
â”‚  â”œâ”€ è¶…æ—¶æ£€æŸ¥: æ¯æ¬¡è¯·æ±‚éªŒè¯                                   â”‚
â”‚  â””â”€ å¹¶å‘é™åˆ¶: æ¯ç”¨æˆ·æœ€å¤š 5 ä¸ªä¼šè¯                             â”‚
â”‚                                                             â”‚
â”‚  Level 3: API Key (å¯é€‰)                                    â”‚
â”‚  â”œâ”€ ç”¨é€”: ç¬¬ä¸‰æ–¹é›†æˆ                                         â”‚
â”‚  â”œâ”€ æ ¼å¼: Bearer Token                                      â”‚
â”‚  â””â”€ æƒé™: å—é™æ“ä½œ (åªè¯»)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. æ•°æ®åŠ å¯†

#### 2.1 é™æ€æ•°æ®åŠ å¯†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   æ•æ„Ÿæ•°æ®åŠ å¯†ç­–ç•¥                            â”‚
â”‚                                                             â”‚
â”‚  ç§é’¥/åŠ©è®°è¯ (éæ‰˜ç®¡æ¨¡å¼: ä¸å­˜å‚¨)                             â”‚
â”‚  â”œâ”€ å‰ç«¯å­˜å‚¨: MetaMask / ç¡¬ä»¶é’±åŒ…                            â”‚
â”‚  â””â”€ åç«¯: ä»…å­˜å‚¨å…¬é’¥åœ°å€ (æ˜æ–‡)                               â”‚
â”‚                                                             â”‚
â”‚  ç”¨æˆ·å¯†ç                                                     â”‚
â”‚  â”œâ”€ ç®—æ³•: Argon2id                                          â”‚
â”‚  â”œâ”€ å‚æ•°: memory=65536KB, iterations=3                     â”‚
â”‚  â””â”€ å­˜å‚¨: å“ˆå¸Œå€¼ (ä¸å¯é€†)                                    â”‚
â”‚                                                             â”‚
â”‚  å†…éƒ¨å¯†é’¥ (å¯†é’¥ç®¡ç†ç³»ç»Ÿ)                                      â”‚
â”‚  â”œâ”€ ç®—æ³•: AES-256-GCM                                       â”‚
â”‚  â”œâ”€ KEK: ä» WALLET_ENC_KEY ç¯å¢ƒå˜é‡æ´¾ç”Ÿ                      â”‚
â”‚  â””â”€ å­˜å‚¨: åŠ å¯†åå­˜å‚¨åœ¨å†…å­˜ (HashMap)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.2 ä¼ è¾“åŠ å¯†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   TLS/HTTPS é…ç½®                             â”‚
â”‚                                                             â”‚
â”‚  åè®®: TLS 1.3 (é¦–é€‰) / TLS 1.2 (å…¼å®¹)                       â”‚
â”‚  å¯†ç å¥—ä»¶:                                                   â”‚
â”‚  â”œâ”€ TLS_AES_256_GCM_SHA384                                  â”‚
â”‚  â”œâ”€ TLS_CHACHA20_POLY1305_SHA256                            â”‚
â”‚  â””â”€ TLS_AES_128_GCM_SHA256                                  â”‚
â”‚                                                             â”‚
â”‚  è¯ä¹¦:                                                       â”‚
â”‚  â”œâ”€ Let's Encrypt (è‡ªåŠ¨ç»­æœŸ)                                 â”‚
â”‚  â””â”€ HSTS: max-age=31536000; includeSubDomains              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. é˜²å¾¡æœºåˆ¶

#### 3.1 é€Ÿç‡é™åˆ¶

```rust
// å…¨å±€é™åˆ¶: 100 è¯·æ±‚/åˆ†é’Ÿ/IP
let rate_limiter = Arc::new(RateLimiter::new(100, Duration::from_secs(60)));

// æ•æ„Ÿæ¥å£é™åˆ¶: 10 è¯·æ±‚/åˆ†é’Ÿ/ç”¨æˆ·
// - ç™»å½•æ¥å£: 5 æ¬¡å¤±è´¥åé”å®š 15 åˆ†é’Ÿ
// - åˆ›å»ºé’±åŒ…: 10 ä¸ª/å°æ—¶/ç”¨æˆ·
// - å‘é€äº¤æ˜“: 60 ç¬”/å°æ—¶/é’±åŒ…
```

#### 3.2 è¾“å…¥éªŒè¯

```rust
// é’±åŒ…åç§°éªŒè¯
fn validate_wallet_name(name: &str) -> Result<()> {
    if name.len() < 3 || name.len() > 50 {
        return Err("Wallet name must be 3-50 characters");
    }
    if !name.chars().all(|c| c.is_alphanumeric() || c == '_' || c == '-') {
        return Err("Wallet name contains invalid characters");
    }
    Ok(())
}

// åœ°å€éªŒè¯
fn validate_wallet_address(address: &str) -> Result<()> {
    // Ethereum åœ°å€: 0x + 40 hex chars
    if address.starts_with("0x") && address.len() == 42 {
        return Ok(());
    }
    Err("Invalid Ethereum address format")
}
```

#### 3.3 SQL æ³¨å…¥é˜²æŠ¤

```rust
// âœ… ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
sqlx::query("SELECT * FROM users WHERE email = ?")
    .bind(email)  // å‚æ•°ç»‘å®šï¼Œé˜²æ­¢æ³¨å…¥
    .fetch_one(&pool)
    .await?;

// âŒ é¿å…å­—ç¬¦ä¸²æ‹¼æ¥
// let query = format!("SELECT * FROM users WHERE email = '{}'", email); // å±é™©ï¼
```

### 4. å®¡è®¡æ—¥å¿—

```rust
pub struct AuditLog {
    pub timestamp: DateTime<Utc>,
    pub user_id: Option<String>,
    pub action: String,
    pub resource: String,
    pub ip_address: String,
    pub user_agent: String,
    pub success: bool,
    pub error_message: Option<String>,
}

// è®°å½•æ•æ„Ÿæ“ä½œ
audit_logger.log(AuditLog {
    action: "wallet_created",
    resource: format!("wallet:{}", wallet_name),
    ip_address: client_ip,
    success: true,
    ...
});
```

---

## éƒ¨ç½²æ¶æ„

### 1. ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       è´Ÿè½½å‡è¡¡å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ NGINX / Cloudflare                                  â”‚  â”‚
â”‚  â”‚ â”œâ”€ TLS ç»ˆç»“                                          â”‚  â”‚
â”‚  â”‚ â”œâ”€ é€Ÿç‡é™åˆ¶ (Layer 7)                                â”‚  â”‚
â”‚  â”‚ â””â”€ è¯·æ±‚åˆ†å‘                                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                   â”‚                   â”‚
       â†“                   â†“                   â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend 1   â”‚  â”‚  Backend 2   â”‚  â”‚  Backend 3   â”‚
â”‚  (Docker)    â”‚  â”‚  (Docker)    â”‚  â”‚  (Docker)    â”‚
â”‚              â”‚  â”‚              â”‚  â”‚              â”‚
â”‚  Port: 8080  â”‚  â”‚  Port: 8080  â”‚  â”‚  Port: 8080  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                   â”‚                   â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â†“
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚        PostgreSQL / SQLite          â”‚
       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
       â”‚  â”‚  Users DB    â”‚  â”‚  Wallets DB  â”‚ â”‚
       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Docker éƒ¨ç½²

```dockerfile
# Dockerfile
FROM rust:1.75 as builder
WORKDIR /app
COPY . .
RUN cargo build --release --features "all-chains"

FROM debian:bookworm-slim
RUN apt-get update && apt-get install -y \
    ca-certificates \
    libssl3 \
    && rm -rf /var/lib/apt/lists/*

COPY --from=builder /app/target/release/hot_wallet /usr/local/bin/

EXPOSE 8080
CMD ["hot_wallet", "server", "--port", "8080"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  backend:
    build: .
    ports:
      - "8080:8080"
    environment:
      - DATABASE_URL=sqlite://./wallets.db
      - USERS_DATABASE_URL=sqlite://./users.db
      - JWT_SECRET=${JWT_SECRET}
      - WALLET_ENC_KEY=${WALLET_ENC_KEY}
      - ETHEREUM_RPC=${ETHEREUM_RPC}
      - POLYGON_RPC=${POLYGON_RPC}
      - BSC_RPC=${BSC_RPC}
    volumes:
      - ./data:/app/data
      - ./logs:/app/logs
    restart: unless-stopped

  nginx:
    image: nginx:alpine
    ports:
      - "443:443"
      - "80:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/nginx.conf
      - ./ssl:/etc/nginx/ssl
    depends_on:
      - backend
    restart: unless-stopped
```

### 3. ç¯å¢ƒå˜é‡é…ç½®

```bash
# .env.production
DATABASE_URL=sqlite://./wallets.db
USERS_DATABASE_URL=sqlite://./users.db

# å®‰å…¨å¯†é’¥ (å¿…é¡»ä¿®æ”¹)
JWT_SECRET=your-strong-jwt-secret-256-bits
WALLET_ENC_KEY=base64-encoded-32-bytes-key
API_KEY=your-api-key-for-third-party

# åŒºå—é“¾ RPC
ETHEREUM_RPC=https://eth-mainnet.alchemyapi.io/v2/YOUR-KEY
POLYGON_RPC=https://polygon-mainnet.alchemyapi.io/v2/YOUR-KEY
BSC_RPC=https://bsc-dataseed.binance.org/

# CORS é…ç½®
CORS_ALLOW_ORIGIN=https://your-frontend-domain.com

# æ—¥å¿—çº§åˆ«
RUST_LOG=info,hyper=warn,h2=warn
```

---

## å¼€å‘è§„èŒƒ

### 1. ä»£ç é£æ ¼

```bash
# æ ¼å¼åŒ–ä»£ç 
cargo fmt

# ä»£ç æ£€æŸ¥
cargo clippy -- -D warnings

# è¿è¡Œæµ‹è¯•
cargo test

# æµ‹è¯•è¦†ç›–ç‡
cargo tarpaulin --out Html
```

### 2. Git æäº¤è§„èŒƒ

```
feat: æ·»åŠ æ–°åŠŸèƒ½
fix: ä¿®å¤ Bug
docs: æ–‡æ¡£æ›´æ–°
style: ä»£ç æ ¼å¼è°ƒæ•´
refactor: ä»£ç é‡æ„
test: æµ‹è¯•ç›¸å…³
chore: æ„å»º/å·¥å…·é“¾ç›¸å…³

ç¤ºä¾‹:
feat(wallet): add multi-signature wallet support
fix(api): fix balance query for polygon network
docs(readme): update deployment guide
```

### 3. æµ‹è¯•è§„èŒƒ

```rust
#[cfg(test)]
mod tests {
    use super::*;
    
    #[tokio::test]
    async fn test_create_wallet_success() {
        // Arrange
        let config = WalletConfig::default();
        let manager = WalletManager::new(&config).await.unwrap();
        
        // Act
        let result = manager.create_wallet("test_wallet", "password", false).await;
        
        // Assert
        assert!(result.is_ok());
    }
    
    #[tokio::test]
    async fn test_create_wallet_duplicate() {
        // Arrange
        let config = WalletConfig::default();
        let manager = WalletManager::new(&config).await.unwrap();
        manager.create_wallet("test", "pass", false).await.unwrap();
        
        // Act
        let result = manager.create_wallet("test", "pass", false).await;
        
        // Assert
        assert!(result.is_err());
        assert!(matches!(result.unwrap_err(), WalletError::ValidationError(_)));
    }
}
```

### 4. æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | å®é™… |
|------|------|------|
| API å“åº”æ—¶é—´ (P95) | < 100ms | ~50ms |
| äº¤æ˜“ç­¾åæ—¶é—´ | < 50ms | ~20ms |
| å¹¶å‘è¯·æ±‚æ•° | 100 | 100 |
| å†…å­˜ä½¿ç”¨ | < 100MB | ~80MB |
| å¯åŠ¨æ—¶é—´ | < 3s | ~2s |

---

## æ€»ç»“

è¿™æ˜¯ä¸€ä¸ª**ç”Ÿäº§çº§åˆ«çš„åŒºå—é“¾é’±åŒ…åç«¯ç³»ç»Ÿ**ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

âœ… **æ¨¡å—åŒ–è®¾è®¡**: 30+ å­æ¨¡å—ï¼ŒèŒè´£æ¸…æ™°  
âœ… **é«˜å®‰å…¨æ€§**: AES-256-GCMã€Argon2idã€JWTã€é˜²æŠ¤æœºåˆ¶é½å…¨  
âœ… **é«˜æ€§èƒ½**: å¼‚æ­¥ I/Oã€è¿æ¥æ± ã€é€Ÿç‡é™åˆ¶  
âœ… **å¯æ‰©å±•**: æ’ä»¶ç³»ç»Ÿã€å¤šé“¾æ”¯æŒ  
âœ… **å¯ç»´æŠ¤**: 140+ æµ‹è¯•æ–‡ä»¶ã€95% æµ‹è¯•è¦†ç›–ç‡  
âœ… **ä¼ä¸šçº§**: å®¡è®¡æ—¥å¿—ã€ç›‘æ§æŒ‡æ ‡ã€å¥åº·æ£€æŸ¥  

---

**æœ€åæ›´æ–°**: 2024-11-13  
**ç»´æŠ¤è€…**: DarkCrab-Rust  
**è®¸å¯è¯**: MIT OR Apache-2.0

